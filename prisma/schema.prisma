generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model comunicacao {
  id_comunicacao                               Int              @id @default(autoincrement())
  tipo                                         comunicacao_tipo
  id_remetente                                 Int
  id_destinatario                              Int
  assunto                                      String?
  mensagem                                     String
  data_envio                                   DateTime         @default(now())
  usuario_comunicacao_id_destinatarioTousuario usuario          @relation("comunicacao_id_destinatarioTousuario", fields: [id_destinatario], references: [id_usuario], map: "Comunicacao_id_destinatario_fkey")
  usuario_comunicacao_id_remetenteTousuario    usuario          @relation("comunicacao_id_remetenteTousuario", fields: [id_remetente], references: [id_usuario], map: "Comunicacao_id_remetente_fkey")

  @@index([id_destinatario], map: "Comunicacao_id_destinatario_idx")
  @@index([id_remetente], map: "Comunicacao_id_remetente_fkey")
  @@index([tipo], map: "Comunicacao_tipo_idx")
}

model funcionario {
  id_funcionario Int       @id @default(autoincrement())
  id_usuario     Int
  telefone       String?
  cargo          String?
  salario        Float?
  usuario        usuario   @relation(fields: [id_usuario], references: [id_usuario], map: "Funcionario_id_usuario_fkey")
  servico        servico[]
  upload         upload[]

  @@index([id_usuario], map: "Funcionario_id_usuario_fkey")
}

model servico {
  id_servico     Int         @id @default(autoincrement())
  id_funcionario Int
  video          String?
  imagem         String?
  descri         String?
  funcionario    funcionario @relation(fields: [id_funcionario], references: [id_funcionario], map: "Servico_id_funcionario_fkey")

  @@index([id_funcionario], map: "Servico_id_funcionario_fkey")
}

model upload {
  id_upload      Int         @id @default(autoincrement())
  id_funcionario Int
  video          String?
  imagem         String?
  descri         String?
  funcionario    funcionario @relation(fields: [id_funcionario], references: [id_funcionario], map: "Upload_id_funcionario_fkey")

  @@index([id_funcionario], map: "Upload_id_funcionario_fkey")
}

model usuario {
  id_usuario                                       Int           @id @default(autoincrement())
  nome                                             String
  email                                            String        @unique(map: "Usuario_email_key")
  BI                                               String        @unique(map: "Usuario_BI_key")
  senha                                            String?
  role                                             usuario_role  @default(CLIENTE)
  comunicacao_comunicacao_id_destinatarioTousuario comunicacao[] @relation("comunicacao_id_destinatarioTousuario")
  comunicacao_comunicacao_id_remetenteTousuario    comunicacao[] @relation("comunicacao_id_remetenteTousuario")
  funcionario                                      funcionario[]
}

enum comunicacao_tipo {
  contrato
  sms
}

enum usuario_role {
  ADMIN
  CLIENTE
}
